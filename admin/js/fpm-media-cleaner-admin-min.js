!function($){"use strict";function e(e,t){return $.post(ajaxurl,{action:e,...t}).pipe((function(e){try{return JSON.parse(e)}catch(t){return function(e,t="log"){console[t]("----------------------------------"),console[t]("[FPM Media Cleaner]"),console[t](`${e}`),console[t]("----------------------------------")}(t.message,"error"),e}}))}function t(){return{status:document.querySelector("[data-options-status]"),lastUpdate:document.querySelector("[data-options-last-update]"),count:document.querySelector("[data-options-count]"),progress:document.querySelector("[data-fpm-media-progress]"),refreshBtn:document.querySelector("[data-fpm-media-cleaner-refresh]"),purgeBtn:document.querySelector("[data-fpm-media-cleaner-remove]"),activeCount:document.querySelector("[data-fpm-media-cleaner-count]")}}function n(e){const t=document.createElement("td");return t.innerHTML=e,t}function o(){const n=t();e("media-clean-get-count",{}).done((function(e){n.activeCount.innerHTML=e;const t=Number.parseInt(n.count.innerHTML),o=Number.parseInt(e);Number.isNaN(t)||Number.isNaN(o)?(n.progress.removeAttribute("max"),n.progress.removeAttribute("value")):(n.progress.setAttribute("max",t),n.progress.setAttribute("value",t-o))})).fail((function(){console.error("error")}))}function r(){const n=t();e("media-clean-get-options",{}).done((function(e){for(const t of e)switch(t.option_key){case"status":n.status.innerHTML=t.option_value,t.option_value.startsWith("process")&&(n.progress.parentNode.classList.add("show"),n.refreshBtn.setAttribute("disabled",""),n.purgeBtn.setAttribute("disabled","")),t.option_value.startsWith("finish")&&(n.progress.parentNode.classList.remove("show"),n.refreshBtn.removeAttribute("disabled"),n.purgeBtn.removeAttribute("disabled"));break;case"last_update":const e=new Date(t.option_value);n.lastUpdate.innerHTML=e.toString();break;case"count":n.count.innerHTML=t.option_value}})).fail((function(){console.error("error")}))}$((function(){document.querySelector("[data-fpm-media-cleaner]")&&(setInterval(o,5e3),setInterval(r,5e3),o(),r(),e("media-clean-get-cache",{}).done((function(e){const t=document.querySelector("[data-clean-media]");if(!t)return alert("Fehler");const o=t.querySelector("tbody");for(const t of e){const e=document.createElement("tr");e.appendChild(n(t.id)),t.guid.indexOf("/uploads"),e.appendChild(n(t.guid)),e.appendChild(n(t.post_modified)),e.appendChild(n(t.post_status)),e.appendChild(n(t.post_title)),e.appendChild(n(t.post_type)),o.appendChild(e)}})).fail((function(){console.error("error")})),document.querySelector("[data-fpm-media-cleaner-refresh]").addEventListener("click",(function(){e("media-clean-fill-cache",{}).done((function(e){console.log("safty",e)})).fail((function(){console.error("error")}))})),document.querySelector("[data-fpm-media-cleaner-remove]").addEventListener("click",(function(){e("media-clean-remove",{}).done((function(e){})).fail((function(){console.error("error")}))})))})),console.log(ajaxurl)}(jQuery);